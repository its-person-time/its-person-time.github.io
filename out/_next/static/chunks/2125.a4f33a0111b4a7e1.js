"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2125,8694,3400],{8694:function(e,t,r){r.r(t),r.d(t,{default:function(){return i}});var n=r(5893),o=(r(7294),r(7927));function i(e){var t=e.children;return(0,n.jsx)(o.M5,{children:(0,n.jsx)(o.xu,{width:"70%",textAlign:"left",children:t})})}},2125:function(e,t,r){r.r(t),r.d(t,{Page:function(){return p}});var n=r(828),o=r(5893),i=r(7294),s=r(8712),a=r(3697),l=r(7881),u=r(2664),h=r(8766),c=r(7741),m=r(8694),d=r(3621),f=r(3400),g=r(7927),x=r(3920),p=function(){var e=(0,u.I0)(),t=(0,n.Z)((0,l.Z)(["wantToBuy"]),1)[0],r=(0,d.useBlockchainContext)(),p=r.signer,y=r.contractConnection,w=r.chainId,v=(0,n.Z)(i.useState(!0),2),b=v[0],j=v[1],S=(0,n.Z)(i.useState(!1),2),_=S[0],k=S[1],F=(0,n.Z)(i.useState(!1),2),T=F[0],E=F[1];return i.useEffect((function(){y&&y.totalMinted().then((function(e){j(e<7)})).catch((function(e){console.log(e)}))}),[]),i.useEffect((function(){p&&0!=p.length&&!T&&y&&y.totalMintedTo(p).then((function(e){k(e>0)})).catch((function(e){console.log(e)}))}),[p]),(0,o.jsx)(m.default,{children:(0,o.jsx)(s.WC,{filename:"chapter5",children:(0,o.jsxs)(s.$0,{children:["Yes"===t&&(0,o.jsx)("p",{children:'"I\'m sure."'}),"no"===t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:"\"Hm...you're right. Maybe they'd be better off with someone else. What else do you have?\""}),(0,o.jsx)("p",{children:"She smiles at you, her sharp teeth glistening in the dim light. \"You're not ready, child. That is okay. Come back another day, perhaps. My collection is always growing. Someday I'll have exactly what you need, I feel it in my bones.\""}),(0,o.jsxs)("p",{children:["You thank her quickly and ",(0,o.jsx)(s.JL,{text:"leave",next:"chapter6"}),". You get the sense you're lucky she's not offended."]})]}),!p&&"Yes"===t&&(0,o.jsx)("p",{children:(0,o.jsx)("i",{children:"Psst! Connect your wallet above."})}),(0,o.jsx)(s.nA,{condition:"Yes"===t&&p&&!_&&b,children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:"With a snap of her finders, The Shopkeeper stretches out her palm to reveal a small wooden box covered in unintelligble symbols. She opens it to reveal a small, dim gem. It looks pale and dusty, almost translucent."}),(0,o.jsxs)(s.nA,{condition:T,otherwise:(0,o.jsxs)("div",{children:[(0,o.jsx)(f.MintModal,{onSuccess:function(){E(!0)},onError:function(t){t.includes("user rejected transaction")&&e((0,h.Ac)("wantToBuy","no",a.o6.None))}})," ",(0,o.jsx)(c.zx,{onClick:function(){e((0,h.Ac)("wantToBuy","no",a.o6.None))},children:"Nevermind"})]}),children:[(0,o.jsx)("p",{children:'"When I first took the gems," she said, stroking her frilly fingers across its surface, "They glowed so beautifully. They faded with age. I\'m not sure they remember their past anymore."'}),(0,o.jsx)("p",{children:"But as she places the gem in your out-stretched palm, it begins to glow, taking on a shiny red hue. Like a glistening ruby."}),(0,o.jsx)("p",{children:'"Hah!" The Shopkeeper barks. "I suppose you just needed a little adventure, huh?" She smiles up at you, her sharp teeth looking more friendly than before. "It was a pleasure doing business with you. You\'re welcome back any time."'}),(0,o.jsxs)("p",{children:['"Thank you," you bow deeply before turning to'," ",(0,o.jsx)(s.JL,{text:"open the door",next:"chapter6"}),'. "This was truly a magical experience. I will take care of it well."']})]})]})}),(0,o.jsx)(s.nA,{condition:"Yes"===t&&p&&!_&&!b,children:(0,o.jsxs)("p",{children:["Funny, you're not the first to come in asking about that. Unfortunately, the gems are gone. Though perhaps by now"," ",(0,o.jsx)(g.rU,{color:"cyan.500",href:x.CONTRACT_INFO[w].openSeaLink,children:"other merchants"})," ","have found them."]})}),(0,o.jsxs)(s.nA,{condition:"Yes"===t&&p&&_,children:[(0,o.jsxs)("p",{children:["\"No, no. We've done business already. The gems came from 7 and must go to 7. Though perhaps"," ",(0,o.jsx)(g.rU,{color:"cyan.500",href:x.CONTRACT_INFO[w].openSeaLink,children:"others"})," ",'are less principled than I. I have nothing else for you!"']}),(0,o.jsxs)("p",{children:["You thank her quickly and ",(0,o.jsx)(s.JL,{text:"leave",next:"chapter6"})," before her mood sours further."]})]})]})})})}},3400:function(e,t,r){r.r(t),r.d(t,{MintModal:function(){return E}});var n=r(828),o=r(5893),i=r(7294),s=r(3621),a=r(6441),l=r(1581),u=r(8794),h=r(2593);const c=new l.Yd(u.i),m={},d=h.O$.from(0),f=h.O$.from(-1);function g(e,t,r,n){const o={fault:t,operation:r};return void 0!==n&&(o.value=n),c.throwError(e,l.Yd.errors.NUMERIC_FAULT,o)}let x="0";for(;x.length<256;)x+=x;function p(e){if("number"!==typeof e)try{e=h.O$.from(e).toNumber()}catch(t){}return"number"===typeof e&&e>=0&&e<=256&&!(e%1)?"1"+x.substring(0,e):c.throwArgumentError("invalid decimal size","decimals",e)}function y(e,t){null==t&&(t=0);const r=p(t),n=(e=h.O$.from(e)).lt(d);n&&(e=e.mul(f));let o=e.mod(r).toString();for(;o.length<r.length-1;)o="0"+o;o=o.match(/^([0-9]*[1-9]|0)(0*)/)[1];const i=e.div(r).toString();return e=1===r.length?i:i+"."+o,n&&(e="-"+e),e}function w(e,t){null==t&&(t=0);const r=p(t);"string"===typeof e&&e.match(/^-?[0-9.]+$/)||c.throwArgumentError("invalid decimal value","value",e);const n="-"===e.substring(0,1);n&&(e=e.substring(1)),"."===e&&c.throwArgumentError("missing value","value",e);const o=e.split(".");o.length>2&&c.throwArgumentError("too many decimal points","value",e);let i=o[0],s=o[1];for(i||(i="0"),s||(s="0");"0"===s[s.length-1];)s=s.substring(0,s.length-1);for(s.length>r.length-1&&g("fractional component exceeds decimals","underflow","parseFixed"),""===s&&(s="0");s.length<r.length-1;)s+="0";const a=h.O$.from(i),l=h.O$.from(s);let u=a.mul(r).add(l);return n&&(u=u.mul(f)),u}class v{constructor(e,t,r,n){e!==m&&c.throwError("cannot use FixedFormat constructor; use FixedFormat.from",l.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=t,this.width=r,this.decimals=n,this.name=(t?"":"u")+"fixed"+String(r)+"x"+String(n),this._multiplier=p(n),Object.freeze(this)}static from(e){if(e instanceof v)return e;"number"===typeof e&&(e=`fixed128x${e}`);let t=!0,r=128,n=18;if("string"===typeof e)if("fixed"===e);else if("ufixed"===e)t=!1;else{const o=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);o||c.throwArgumentError("invalid fixed format","format",e),t="u"!==o[1],r=parseInt(o[2]),n=parseInt(o[3])}else if(e){const o=(t,r,n)=>null==e[t]?n:(typeof e[t]!==r&&c.throwArgumentError("invalid fixed format ("+t+" not "+r+")","format."+t,e[t]),e[t]);t=o("signed","boolean",t),r=o("width","number",r),n=o("decimals","number",n)}return r%8&&c.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",r),n>80&&c.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",n),new v(m,t,r,n)}}class b{constructor(e,t,r,n){e!==m&&c.throwError("cannot use FixedNumber constructor; use FixedNumber.from",l.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=n,this._hex=t,this._value=r,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(e){this.format.name!==e.format.name&&c.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",e)}addUnsafe(e){this._checkFormat(e);const t=w(this._value,this.format.decimals),r=w(e._value,e.format.decimals);return b.fromValue(t.add(r),this.format.decimals,this.format)}subUnsafe(e){this._checkFormat(e);const t=w(this._value,this.format.decimals),r=w(e._value,e.format.decimals);return b.fromValue(t.sub(r),this.format.decimals,this.format)}mulUnsafe(e){this._checkFormat(e);const t=w(this._value,this.format.decimals),r=w(e._value,e.format.decimals);return b.fromValue(t.mul(r).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(e){this._checkFormat(e);const t=w(this._value,this.format.decimals),r=w(e._value,e.format.decimals);return b.fromValue(t.mul(this.format._multiplier).div(r),this.format.decimals,this.format)}floor(){const e=this.toString().split(".");1===e.length&&e.push("0");let t=b.from(e[0],this.format);const r=!e[1].match(/^(0*)$/);return this.isNegative()&&r&&(t=t.subUnsafe(j.toFormat(t.format))),t}ceiling(){const e=this.toString().split(".");1===e.length&&e.push("0");let t=b.from(e[0],this.format);const r=!e[1].match(/^(0*)$/);return!this.isNegative()&&r&&(t=t.addUnsafe(j.toFormat(t.format))),t}round(e){null==e&&(e=0);const t=this.toString().split(".");if(1===t.length&&t.push("0"),(e<0||e>80||e%1)&&c.throwArgumentError("invalid decimal count","decimals",e),t[1].length<=e)return this;const r=b.from("1"+x.substring(0,e),this.format),n=S.toFormat(this.format);return this.mulUnsafe(r).addUnsafe(n).floor().divUnsafe(r)}isZero(){return"0.0"===this._value||"0"===this._value}isNegative(){return"-"===this._value[0]}toString(){return this._value}toHexString(e){if(null==e)return this._hex;e%8&&c.throwArgumentError("invalid byte width","width",e);const t=h.O$.from(this._hex).fromTwos(this.format.width).toTwos(e).toHexString();return(0,a.$m)(t,e/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return b.fromString(this._value,e)}static fromValue(e,t,r){return null!=r||null==t||(0,h.Zm)(t)||(r=t,t=null),null==t&&(t=0),null==r&&(r="fixed"),b.fromString(y(e,t),v.from(r))}static fromString(e,t){null==t&&(t="fixed");const r=v.from(t),n=w(e,r.decimals);!r.signed&&n.lt(d)&&g("unsigned value cannot be negative","overflow","value",e);let o=null;r.signed?o=n.toTwos(r.width).toHexString():(o=n.toHexString(),o=(0,a.$m)(o,r.width/8));const i=y(n,r.decimals);return new b(m,o,i,r)}static fromBytes(e,t){null==t&&(t="fixed");const r=v.from(t);if((0,a.lE)(e).length>r.width/8)throw new Error("overflow");let n=h.O$.from(e);r.signed&&(n=n.fromTwos(r.width));const o=n.toTwos((r.signed?0:1)+r.width).toHexString(),i=y(n,r.decimals);return new b(m,o,i,r)}static from(e,t){if("string"===typeof e)return b.fromString(e,t);if((0,a._t)(e))return b.fromBytes(e,t);try{return b.fromValue(e,0,t)}catch(r){if(r.code!==l.Yd.errors.INVALID_ARGUMENT)throw r}return c.throwArgumentError("invalid FixedNumber value","value",e)}static isFixedNumber(e){return!(!e||!e._isFixedNumber)}}const j=b.from(1),S=b.from("0.5"),_=new l.Yd("units/5.7.0"),k=["wei","kwei","mwei","gwei","szabo","finney","ether"];function F(e){return function(e,t){if("string"!==typeof e&&_.throwArgumentError("value must be a string","value",e),"string"===typeof t){const e=k.indexOf(t);-1!==e&&(t=3*e)}return w(e,null!=t?t:18)}(e,18)}var T=r(2562),E=function(e){var t=e.onSuccess,r=e.onError,a=(0,s.useBlockchainContext)().contractConnection,l=(0,n.Z)(i.useState(""),2),u=l[0],h=l[1];i.useEffect((function(){a&&a.mintFee().then((function(e){var t=e/Math.pow(10,17);h(t.toString())}))}),[a]);return(0,o.jsx)(T.ContractWriteModal,{triggerButtonText:"Buy",triggerButtonColorScheme:"yellow",header:"Buy a gem",confirmButtonText:"Buy",inProgressMessage:"completing transaction, please wait until the transaction is confirmed...",successMessage:"Gem purchased!",modalBody:(0,o.jsxs)("span",{children:["This gem costs ",u," ETH. You may only buy one gem from The Shopkeeper directly, and you may only hold 3 gems at a time. Ready? Note that this action requires Metamask."]}),callContract:function(e){return e.mint({value:F(u)})},onSuccess:t,onError:r})}}}]);